(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bc85b7f4","chunk-2d208c19"],{8850:function(e,t,n){"use strict";n.r(t);var o,s=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"drag",rawName:"v-drag"}],staticClass:"drag-w"},[e._v("东北大米真好吃，你想吃几碗")])},i=[],a=n("1e56"),l=n("56c3"),r=(n("4521"),n("a7b5"),n("ad6c"),n("c30d"),n("7c25"),n("dab7"),n("9b0e"),n("cd74"),n("c619"),n("2e90")),c=n("9d26"),d=n("8f33"),u=n("eb44"),g=(n("3aff"),n("906c")),h=n("82ae"),f=n.n(h),m=n("39d1"),p=n("e86d");n("aa15");f.a.default.withCredentials=!0;var w=(o={directives:{drag:function(e){var t=e;t.onclick=function(e){if(console.log("e onclick"),console.log(e),"drag-w"==t.className)return t.className="drag-d",!0;t.className="drag-w"},document.onselectstart=function(){return!1},t.onmousedown=function(e){if("drag-d"==t.className)return!0;var n=e.clientX-t.offsetLeft,o=e.clientY-t.offsetTop;return document.onmousemove=function(e){var s=e.clientX-n,i=e.clientY-o;t.style.left=s+"px",t.style.top=i+"px"},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null},!1}}},name:"Main",components:{List:r["a"],Content:c["a"],Info:d["a"],LineControl:u["a"]}},Object(a["a"])(o,"directives",{move:function(e,t){e.onmousedown=function(e){var t=e.clientX,n=document.getElementById("silderLeft"),o=n.offsetWidth;document.onmousemove=function(e){var s=e.clientX,i=s-t+o;n.style.width=i+"px"},document.onmouseup=function(){document.onmousemove=document.onmouseup=null}}},drag:function(e){var t=e;t.onclick=function(e){if(console.log("e onclick"),console.log(e),"drag-w"==t.className)return t.className="drag-d",!0;t.className="drag-w"},document.onselectstart=function(){return!1},t.onmousedown=function(e){if("drag-d"==t.className)return!0;var n=e.clientX-t.offsetLeft,o=e.clientY-t.offsetTop;return document.onmousemove=function(e){var s=e.clientX-n,i=e.clientY-o;t.style.left=s+"px",t.style.top=i+"px"},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null},!1}}}),Object(a["a"])(o,"data",(function(){return{drawObj:null,nowItem:null,list:Array,draw:{text:Array,begin:Array,circle:Array,lines:Array},createNodesNum:2,lineRules:{type:"broken",theta:30,width:1,headlen:10,color:"#225618",controlX:150,controlY:550},info:JSON,beginNum:"",textNum:"",circleNum:"",saveFlag:!0,lineFlag:!1,lineBeginNode:JSON}})),Object(a["a"])(o,"destroyed",(function(){this.drawObj=null})),Object(a["a"])(o,"methods",{nowcoderCommunityJump:function(){location.href="http://localhost:8081/community/index"},getExpressDemo:function(){var e="users";f.a.get(g["a"].expressDemoBaseUrl+e).then((function(e){console.log("res expressDemoBaseUrl"),console.log(e)}))},get_articles:function(){var e="article/articles";f.a.get(g["a"].expressDemoBaseUrl+e).then((function(e){console.log("res expressDemoBaseUrl"),console.log(e)}))},getList:function(){var e={code:1,message:"成功",response:{records:[{id:1,componentName:"开始节点",height:50,icon:null,left:0,top:0,type:"begin",width:200},{id:2,componentName:"文本节点",height:50,icon:null,left:0,top:0,type:"text",width:200},{id:3,componentName:"圆形节点",height:100,icon:null,left:0,top:0,type:"circle",width:100}],total:3,size:10,current:1,orders:[],optimizeCountSql:!0,hitCount:!1,countId:null,maxLimit:null,searchCount:!0,pages:1}};this.componentButtonsSetUp(e)},componentButtonsSetUp:function(e){var t;this.list=e.data||(null===(t=e.response)||void 0===t?void 0:t.records),this.list.map((function(e){e.name=e.componentName}))},getListByNodeJs:function(){var e=this;f.a.get(g["a"].drawUrl+"component").then((function(t){e.list=t.data.data}))},getList_fetch:function(){var e=this;f.a.get(g["a"].drawUrl+"component").then((function(t){e.list=t.data.data}))},getDrawByExpressJs:function(){var e=this;f.a.get(g["a"].drawUrl+"draw").then((function(t){console.log("res"),console.log(t);var n=t.data.content||t.data.data.content;console.log("content"),console.log(n);var o=JSON.parse(n);e.draw=o,e.beginNum=0===o.begin.length?0:o.begin[o.begin.length-1].id,e.textNum=0===o.text.length?0:o.text[o.text.length-1].id,e.circleNum=0===o.circle.length?0:o.circle[o.circle.length-1].id}))},getDraw:function(){var e=this;p["a"].selectPageEqual({pageNumber:1,pageSize:10},{id:1}).then((function(t){var n,o,s,i;console.log("res"),console.log(t);var a=(null===(n=t.data)||void 0===n?void 0:n.content)||(null===(o=t.data)||void 0===o?void 0:o.data.content)||(null===(s=t.response)||void 0===s||null===(i=s.records[0])||void 0===i?void 0:i.content);console.log("content"),console.log(a);var l=JSON.parse(a);e.draw=l,e.beginNum=0===l.begin.length?0:l.begin[l.begin.length-1].id,e.textNum=0===l.text.length?0:l.text[l.text.length-1].id,e.circleNum=0===l.circle.length?0:l.circle[l.circle.length-1].id}))},getDrawById:function(){var e=this;f.a.post(g["a"].drawUrl+"draw/getDrawById",{id:1}).then((function(t){console.log("res"),console.log(t);var n=t.data.content||t.data.data.content;console.log("content"),console.log(n);var o=JSON.parse(n);e.draw=o,e.beginNum=0===o.begin.length?0:o.begin[o.begin.length-1].id,e.textNum=0===o.text.length?0:o.text[o.text.length-1].id,e.circleNum=0===o.circle.length?0:o.circle[o.circle.length-1].id}))},getDraw_fetch:function(){console.log("getDraw_fetch"),fetch(g["a"].drawUrl+"draw",{method:"GET",headers:{"Content-Type":"application/json; charset=UTF-8"}}).then((function(e){console.log("rss",e)})).catch((function(e){console.log(e)}))},clearDraw:function(){this.draw={text:[],begin:[],circle:[],lines:[]}},saveDrawSpb:function(e){var t,n=this,o=null===(t=this.$route.query)||void 0===t?void 0:t.question_id;console.log("questionId"),console.log(o),f.a.post(g["a"].examUrl+"draw/save",e).then((function(e){var t,s,i,a;console.log("res"),console.log(e);e.data.data;console.log("res.response"),console.log(e.response);var l=(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(s=t.response)||void 0===s?void 0:s.id)||(null===e||void 0===e||null===(i=e.data)||void 0===i||null===(a=i.results)||void 0===a?void 0:a.insertId),r={drawId:l,id:null,questionId:o};n.saveNewQuestionDraw(r),n.$message({message:"画布保存成功",type:"success"})}))},drawGet:function(e){var t=this,n=e[0],o=n.drawId;console.log("drawId"),console.log(o);var s={content:null,id:o};f.a.post(g["a"].examUrl+"draw/selectPage?pageNumber=".concat(0,"&pageSize=",1),s).then((function(e){console.log("res"),console.log(e);var n=e.data.response.records;if(0==n.length){var o={id:null,content:"{}"};t.drawObj=o;var s=JSON.parse(draw.content);console.log("data"),console.log(s),t.drawInit(s)}else{var i=n[0];console.log("draw"),console.log(i),t.drawObj=i;var a=JSON.parse(i.content);console.log("data"),console.log(a),t.draw=a,console.log(" this.draw"),console.log(t.draw),t.beginNum=0===a.begin.length?0:a.begin[a.begin.length-1].id,t.textNum=0===a.text.length?0:a.text[a.text.length-1].id,t.circleNum=0===a.circle.length?0:a.circle[a.circle.length-1].id}}))},drawInit:function(e){this.draw=e,console.log(" this.draw"),console.log(this.draw),this.beginNum=0===e.begin.length?0:e.begin[e.begin.length-1].id,this.textNum=0===e.text.length?0:e.text[e.text.length-1].id,this.circleNum=0===e.circle.length?0:e.circle[e.circle.length-1].id},selectPageQuestionDrawGet:function(e){var t=this,n={drawId:null,id:null,questionId:e},o=g["a"].examUrl;f.a.post(o+"questionDraw/selectPageEqual?pageNumber=".concat(0,"&pageSize=",1),n).then((function(e){console.log("res"),console.log(e);var n=e.data.response.records;if(0==n.length){var o={id:null,content:'{"text":[],"begin":[],"circle":[],"lines":[]}'};t.drawObj=o;var s=JSON.parse(o.content);console.log("data"),console.log(s),t.drawInit(s)}else t.drawGet(n)}))},selectPageQuestionDraw:function(){var e,t=this,n=null===(e=this.$route.query)||void 0===e?void 0:e.question_id,o={drawId:null,id:null,questionId:n},s=g["a"].examUrl;f.a.post(s+"questionDraw/selectPage?pageNumber=".concat(0,"&pageSize=",1),o).then((function(e){console.log("res"),console.log(e);var n=e.data.response.records;if(0==n.length){var o=JSON.stringify(t.draw),s={content:o};t.saveDrawSpb(s)}else{var i=n[0];i.drawId}}))},saveDrawDo:function(){var e=this;g["a"].examUrl;if(this.drawObj){var t=JSON.stringify(this.draw);this.drawObj.content=t,f.a.post(g["a"].examUrl+"draw/save",this.drawObj).then((function(t){if(console.log("res draw save saveDrawDo"),console.log(t),1===t.data.code){var n;e.$message({message:"画布保存成功",type:"success"});var o=t.data.response.id,s=null===(n=e.$route.query)||void 0===n?void 0:n.question_id,i={drawId:o,id:null,questionId:s};console.log("postData saveNewQuestionDraw"),console.log(i),e.saveNewQuestionDraw(i)}else e.$message.error("画布保存失败")}))}else{t=JSON.stringify(this.draw);var n={content:t};this.saveDrawSpb(n)}},saveDraw:function(){var e=this,t=JSON.stringify(this.draw),n={content:t};f.a.post(g["a"].drawUrl+"draw/save",n).then((function(t){1===t.data.code?e.$message({message:"画布保存成功",type:"success"}):e.$message.error("画布保存失败")}))},save:function(e){var t=this,n=g["a"].examUrl;f.a.post(n+"questionDraw/save",e).then((function(e){console.log("res"),console.log(e);e.data.data;var n=e.data.response;n&&t.$message("保存成功 saveNewQuestionDraw")}))},saveNewQuestionDraw:function(e){var t=this,n=g["a"].examUrl;f.a.post(n+"questionDraw/save",e).then((function(e){console.log("res"),console.log(e);var n=e.data.response;n&&t.$message.success("保存成功 saveNewQuestionDraw")}))},saveQuestionDraw:function(){var e=JSON.stringify(this.draw),t={content:e};this.saveDrawSpb(t)},saveNew_do:function(){var e=this,t=JSON.stringify(this.draw),n={content:t};f.a.post(g["a"].drawUrl+"draw/saveNew",n).then((function(t){if(1===t.data.code){t.data.results.insertId,e.$query.question_id;e.$message({message:"画布保存成功",type:"success"})}else e.$message.error("画布保存失败")}))},setNodeInfo:function(e){this.info=e,this.draw.lines=this.draw.lines.map((function(t){return t.beginNode.id===e.id&&t.beginNode.type===e.type?(t.fromX="circle"===e.type?e.left+75:e.left+100,t.fromY="circle"===e.type?e.top+75:e.top+25):t.endNode.id===e.id&&t.endNode.type===e.type&&(t.toX=e.left+50,t.toY=e.top+50),t})),e.updata?this.saveFlag=!1:this.saveFlag=!0},saveNodeInfoFront:function(e){console.log("node"),console.log(e),console.log("this.draw"),console.log(this.draw);var t=this.draw[e.type].filter((function(t){if(t.id===e.id)return!0}));console.log("drawFind"),console.log(t)},saveNodeInfo:function(e){var t=this,n=new URLSearchParams;e=JSON.stringify(e),n.append("component",e),f.a.post(g["a"].drawUrl+"component/updata",n).then((function(e){1===e.data.code?t.$message({message:"节点更新成功",type:"success"}):t.$message.error("节点更新失败")})).then((function(){t.getList()}))},removeNode:function(e){var t=e.type;"text"===t?this.draw.text=this.draw.text.filter((function(t){return t!==e.delItem})):"begin"===t?this.draw.begin=this.draw.begin.filter((function(t){return t!==e.delItem})):"circle"===t&&(this.draw.circle=this.draw.circle.filter((function(t){return t!==e.delItem}))),this.draw.lines=this.draw.lines.filter((function(t){return!(t.beginNode.id===e.delItem.id&&t.beginNode.type===e.delItem.type)&&!(t.endNode.id===e.delItem.id&&t.endNode.type===e.delItem.type)})),this.$message({message:"节点删除成功",type:"success"})},makeStyle:function(e){return e=m["a"].deepCloneByExtend(this.nowItem),e.id++,e.style.left=e.left+"px",e.style.top=e.top+"px",e.key=e.id+e.type+"-"+e.left+"-"+e.top,this.nowItem=e,e},makeStyleList:function(e){for(var t=this.createNodesNum,n=0;n<t;n++)e=this.makeStyle(e),e.left+=100,confList.push(e)},createNodes:function(e){var t=this.createNodesNum;console.log("conf"),console.log(e),this.nowItem=e;for(var n=[],o=0;o<t;o++){this.nowItem=m["a"].deepCloneByExtend(this.nowItem),this.nowItem.left+=100,this.nowItem.id+=1;var s=this.nowItem;s.key=s.id+s.type+"-"+s.left+"-"+s.top,this.createOneNode(this.nowItem)}console.log("confList"),console.log(n)},createOneNode:function(e){return this.saveFlag=!0,e=Object(l["a"])(Object(l["a"])({},e),{},{style:{left:"",top:""}}),e.style.left=e.left+"px",e.style.top=e.top+"px","text"===e.type?(e.id=++this.textNum,this.draw.text.push(e)):"begin"===e.type?(e.id=++this.beginNum,this.draw.begin.push(e)):"circle"===e.type&&(e.id=++this.circleNum,this.draw.circle.push(e)),this.$message({message:"节点创建成功",type:"success"}),e},createNode:function(e){return this.saveFlag=!0,e=Object(l["a"])(Object(l["a"])({},e),{},{style:{left:"",top:""}}),e.style.left=e.left+"px",e.style.top=e.top+"px","text"===e.type?(e.id=++this.textNum,this.draw.text.push(e)):"begin"===e.type?(e.id=++this.beginNum,this.draw.begin.push(e)):"circle"===e.type&&(e.id=++this.circleNum,this.draw.circle.push(e)),this.$message({message:"节点创建成功",type:"success"}),e},setLine:function(e){if(this.lineFlag&&e!==this.lineBeginNode){var t=75,n=75,o=Object(l["a"])({beginNode:this.lineBeginNode,endNode:e,fromX:"circle"===this.lineBeginNode.type?this.lineBeginNode.left+t:this.lineBeginNode.left+100,fromY:"circle"===this.lineBeginNode.type?this.lineBeginNode.top+n:this.lineBeginNode.top+25,toX:e.left,toY:"circle"===e.type?e.top+75:e.top+25},this.lineRules);this.draw.lines.push(o),console.log("line"),console.log(o),this.lineFlag=!1}else this.lineBeginNode=e,this.lineFlag=!0},updataLinerules:function(e){}}),Object(a["a"])(o,"mounted",(function(){var e;console.log("   this.$route.query"),console.log(this.$route.query),this.getList();var t=null===(e=this.$route.query)||void 0===e?void 0:e.question_id;t&&this.selectPageQuestionDrawGet(t)})),o),v=w,N=(n("88be"),n("e607")),y=Object(N["a"])(v,s,i,!1,null,"45e4c856",null);t["default"]=y.exports},"88be":function(e,t,n){"use strict";n("b37a")},a5c2:function(e,t,n){var o=n("e5a2");e.exports=function(e,t,n){for(var s in t)o(e,s,t[s],n);return e}},b37a:function(e,t,n){}}]);