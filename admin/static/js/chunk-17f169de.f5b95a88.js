(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17f169de"],{"1b2c":function(e,t,n){"use strict";n.r(t);n("a7b5");var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:"form",attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"年级：",prop:"gradeLevel",required:""}},[t("el-select",{attrs:{placeholder:"年级"},on:{change:e.levelChange},model:{value:e.form.gradeLevel,callback:function(t){e.$set(e.form,"gradeLevel",t)},expression:"form.gradeLevel"}},e._l(e.levelEnum,(function(e){return t("el-option",{key:e.key,attrs:{value:e.key,label:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"学科：",prop:"subjectId",required:""}},[t("el-select",{attrs:{placeholder:"学科"},model:{value:e.form.subjectId,callback:function(t){e.$set(e.form,"subjectId",t)},expression:"form.subjectId"}},e._l(e.subjectFilter,(function(e){return t("el-option",{key:e.id,attrs:{value:e.id,label:e.name+" ( "+e.levelName+" )"}})})),1)],1),t("el-form-item",{attrs:{label:"题干：",prop:"title",required:""}},[t("el-input",{on:{focus:function(t){return e.inputClick(e.form,"title")}},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),t("el-form-item",{attrs:{label:"选项：",required:""}},e._l(e.form.items,(function(n,i){return t("el-form-item",{key:n.prefix,staticClass:"question-item-label",attrs:{label:n.prefix,"label-width":"50px"}},[t("el-input",{staticStyle:{width:"50px"},model:{value:n.prefix,callback:function(t){e.$set(n,"prefix",t)},expression:"item.prefix"}}),t("el-input",{staticClass:"question-item-content-input",on:{focus:function(t){return e.inputClick(n,"content")}},model:{value:n.content,callback:function(t){e.$set(n,"content",t)},expression:"item.content"}}),t("el-button",{staticClass:"question-item-remove",attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.questionItemRemove(i)}}})],1)})),1),t("el-form-item",{attrs:{label:"解析：",prop:"analyze",required:""}},[t("el-input",{on:{focus:function(t){return e.inputClick(e.form,"analyze")}},model:{value:e.form.analyze,callback:function(t){e.$set(e.form,"analyze",t)},expression:"form.analyze"}})],1),t("el-form-item",{attrs:{label:"分数：",prop:"score",required:""}},[t("el-input-number",{attrs:{precision:1,step:1,max:100},model:{value:e.form.score,callback:function(t){e.$set(e.form,"score",t)},expression:"form.score"}})],1),t("el-form-item",{attrs:{label:"难度：",required:""}},[t("el-rate",{staticClass:"question-item-rate",model:{value:e.form.difficult,callback:function(t){e.$set(e.form,"difficult",t)},expression:"form.difficult"}})],1),t("el-form-item",{attrs:{label:"正确答案：",prop:"correctArray",required:""}},[t("el-checkbox-group",{model:{value:e.form.correctArray,callback:function(t){e.$set(e.form,"correctArray",t)},expression:"form.correctArray"}},e._l(e.form.items,(function(n){return t("el-checkbox",{key:n.prefix,attrs:{label:n.prefix}},[e._v(e._s(n.prefix))])})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("提交")]),t("el-button",{on:{click:e.resetForm}},[e._v("重置")]),t("el-button",{attrs:{type:"success"},on:{click:e.questionItemAdd}},[e._v("添加选项")]),t("el-button",{attrs:{type:"success"},on:{click:e.showQuestion}},[e._v("预览")])],1)],1),t("el-dialog",{staticStyle:{width:"100%",height:"100%"},attrs:{visible:e.richEditor.dialogVisible,"append-to-body":"","close-on-click-modal":!1,"show-close":!1,center:""},on:{"update:visible":function(t){return e.$set(e.richEditor,"dialogVisible",t)}}},[t("Ueditor",{on:{ready:e.editorReady}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.editorConfirm}},[e._v("确 定")]),t("el-button",{on:{click:function(t){e.richEditor.dialogVisible=!1}}},[e._v("取 消")])],1)],1),t("el-dialog",{staticStyle:{width:"100%",height:"100%"},attrs:{visible:e.questionShow.dialog},on:{"update:visible":function(t){return e.$set(e.questionShow,"dialog",t)}}},[t("QuestionShow",{attrs:{qType:e.questionShow.qType,question:e.questionShow.question,qLoading:e.questionShow.loading}})],1)],1)},o=[],r=n("56c3"),s=(n("d2b4"),n("c619"),n("7c25"),n("ad6c"),n("294d")),a=n("63f4"),l=n("7736"),c=n("2ac8"),u={components:{Ueditor:a["a"],QuestionShow:s["a"]},data:function(){return{form:{id:null,questionType:2,gradeLevel:null,subjectId:null,title:"",items:[{id:null,prefix:"A",content:""},{id:null,prefix:"B",content:""},{id:null,prefix:"C",content:""},{id:null,prefix:"D",content:""}],analyze:"",correct:"",correctArray:[],score:"",difficult:0},subjectFilter:null,formLoading:!1,rules:{gradeLevel:[{required:!0,message:"请选择年级",trigger:"change"}],subjectId:[{required:!0,message:"请选择学科",trigger:"change"}],title:[{required:!0,message:"请输入题干",trigger:"blur"}],analyze:[{required:!0,message:"请输入解析",trigger:"blur"}],score:[{required:!0,message:"请输入分数",trigger:"blur"}],correctArray:[{required:!0,message:"请选择正确答案",trigger:"change"}]},richEditor:{dialogVisible:!1,object:null,parameterName:"",instance:null},questionShow:{qType:0,dialog:!1,question:null,loading:!1}}},created:function(){var e=this.$route.query.id,t=this;this.initSubject((function(){t.subjectFilter=t.subjects})),e&&0!==parseInt(e)&&(t.formLoading=!0,c["a"].select(e).then((function(e){t.form=e.response,t.formLoading=!1})))},methods:Object(r["a"])(Object(r["a"])({editorReady:function(e){this.richEditor.instance=e;var t=this.richEditor.object[this.richEditor.parameterName];this.richEditor.instance.setContent(t),this.richEditor.instance.focus(!0)},inputClick:function(e,t){this.richEditor.object=e,this.richEditor.parameterName=t,this.richEditor.dialogVisible=!0},editorConfirm:function(){var e=this.richEditor.instance.getContent();this.richEditor.object[this.richEditor.parameterName]=e,this.richEditor.dialogVisible=!1},questionItemRemove:function(e){this.form.items.splice(e,1)},questionItemAdd:function(){var e,t=this.form.items;if(t.length>0){var n=t[t.length-1];e=String.fromCharCode(n.prefix.charCodeAt()+1)}else e="A";t.push({id:null,prefix:e,content:""})},submitForm:function(){var e=this,t=this;this.$refs.form.validate((function(n){if(!n)return e.$message("not valid"),!1;e.formLoading=!0,c["a"].edit(e.form).then((function(n){1===n.code?(t.$message.success(n.message),t.delCurrentView(t).then((function(){t.$router.push("/exam/question/list")}))):(t.$message.error(n.message),e.formLoading=!1)})).catch((function(t){console.log(t),e.formLoading=!1}))}))},levelChange:function(){var e=this;this.form.subjectId=null,this.subjectFilter=this.subjects.filter((function(t){return t.level===e.form.gradeLevel}))},showQuestion:function(){this.questionShow.dialog=!0,this.questionShow.qType=this.form.questionType,this.questionShow.question=this.form},resetForm:function(){var e=this.form.id;this.$refs["form"].resetFields(),this.form={id:null,questionType:2,gradeLevel:null,subjectId:null,title:"",items:[{id:null,prefix:"A",content:""},{id:null,prefix:"B",content:""},{id:null,prefix:"C",content:""},{id:null,prefix:"D",content:""}],analyze:"",correct:"",correctArray:[],score:"",difficult:0},this.form.id=e}},Object(l["b"])("exam",{initSubject:"initSubject"})),Object(l["b"])("tagsView",{delCurrentView:"delCurrentView"})),computed:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(l["c"])("enumItem",["enumFormat"])),Object(l["e"])("enumItem",{questionTypeEnum:function(e){return e.exam.question.typeEnum},levelEnum:function(e){return e.user.levelEnum}})),Object(l["e"])("exam",{subjects:function(e){return e.subjects}}))},d=u,m=n("e607"),f=Object(m["a"])(d,i,o,!1,null,null,null);t["default"]=f.exports},"28d7":function(e,t,n){},"294d":function(e,t,n){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"line-height":"1.8"}},[1==e.qType||2==e.qType?t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.qLoading,expression:"qLoading"}]},[t("div",{staticClass:"q-title",domProps:{innerHTML:e._s(e.question.title)}}),t("div",{staticClass:"q-content"},e._l(e.question.items,(function(n){return t("span",{key:n.id,staticClass:"q-item-contain"},[t("span",{staticClass:"q-item-prefix"},[e._v(e._s(n.prefix))]),t("span",{staticClass:"q-item-content",domProps:{innerHTML:e._s(n.content)}})])})),0)]):3==e.qType?t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.qLoading,expression:"qLoading"}]},[t("div",{staticClass:"q-title",staticStyle:{display:"inline","margin-right":"10px"},domProps:{innerHTML:e._s(e.question.title)}}),t("span",[e._v("（")]),e._l(e.question.items,(function(n){return t("span",{key:n.id},[t("span",{staticClass:"q-item-content",domProps:{innerHTML:e._s(n.content)}})])})),t("span",[e._v("）")])],2):4==e.qType||5==e.qType?t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.qLoading,expression:"qLoading"}]},[t("div",{staticClass:"q-title",domProps:{innerHTML:e._s(e.question.title)}}),t("div",{domProps:{innerHTML:e._s(e.question.correct)}})]):t("div")])},o=[],r=(n("ea1e"),{name:"QuestionShow",props:{question:{type:Object,default:function(){return{}}},qLoading:{type:Boolean,default:!1},qType:{type:Number,default:0}},methods:{}}),s=r,a=n("e607"),l=Object(a["a"])(s,i,o,!1,null,null,null);t["a"]=l.exports},"2ac8":function(e,t,n){"use strict";var i=n("b775"),o="/api/admin/question";t["a"]={pageList:function(e){return Object(i["a"])("/api/admin/question/page",e)},edit:function(e){return Object(i["a"])("/api/admin/question/edit",e)},select:function(e){return Object(i["a"])("/api/admin/question/select/"+e)},deleteQuestion:function(e){return Object(i["a"])("/api/admin/question/delete/"+e)},insertBatch:function(e){return Object(i["a"])("/api/admin/question/insertBatch/",e)},findAllEs:function(e){return Object(i["a"])("/api/admin/question/findAllEs/",e)},save:function(e,t){return Object(i["c"])("".concat(o,"/save"),e,t)},autoPaper:function(e){return Object(i["a"])("/api/admin/question/autoPaper",e)},saveAll:function(e,t){return Object(i["c"])("".concat(o,"/saveAll"),e,t)},deleteBy:function(e,t){return Object(i["c"])("".concat(o,"/deleteBy"),e,t)},selectPageEqual:function(e,t){return Object(i["c"])("".concat(o,"/selectPageEqual"),e,t)},selectByExample:function(e,t){return Object(i["c"])("".concat(o,"/selectByExample"),e,t)},selectPage:function(e,t){return Object(i["c"])("".concat(o,"/selectPage"),e,t)},removeByIds:function(e,t){return Object(i["c"])("".concat(o,"/removeByIds"),e,t)},selectPlusPage:function(e,t){return Object(i["c"])("".concat(o,"/selectPlusPage"),e,t)}}},"63f4":function(e,t,n){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",[t("script",{staticStyle:{height:"300px"},attrs:{id:e.randomId,type:"text/plain"}}),t("el-button",{on:{click:e.getUEContentTest}},[e._v("getUEContentTest")]),t("el-button",{on:{click:e.insertFomuleTest}},[e._v("insertFomuleTest")]),t("el-button",{on:{click:e.getUEHtml}},[e._v("getUEHtml")]),t("el-button",{on:{click:e.setUEHtml}},[e._v("setUEHtml")])],1)},o=[];n("9bb8"),n("73d1"),n("ad6c"),n("57b9");function r(e,t,n){var i=[],o=Math.max(e.length,t.length),r=0,s=0;while(s<o||r){var a=s<e.length?e[s]:0,l=s<t.length?t[s]:0,c=r+a+l;i.push(c%n),r=Math.floor(c/n),s++}return i}function s(e,t,n){if(e<0)return null;if(0==e)return[];var i=[],o=t;while(1){if(1&e&&(i=r(i,o,n)),e>>=1,0===e)break;o=r(o,o,n)}return i}function a(e,t){for(var n=e.split(""),i=[],o=n.length-1;o>=0;o--){var r=parseInt(n[o],t);if(isNaN(r))return null;i.push(r)}return i}function l(e,t,n){var i=a(e,t);if(null===i)return null;for(var o=[],l=[1],c=0;c<i.length;c++)i[c]&&(o=r(o,s(i[c],l,n),n)),l=s(t,l,n);var u="";for(c=o.length-1;c>=0;c--)u+=o[c].toString(n);return u}function c(e){return"0x"===e.substring(0,2)&&(e=e.substring(2)),e=e.toLowerCase(),l(e,16,10)}class u{constructor(e){e=e||{},this.seq=0,this.mid=(e.mid||1)%1023,this.offset=e.offset||0,this.lastTime=0}generate(){const e=Date.now(),t=(e-this.offset).toString(2);if(this.lastTime==e){if(this.seq++,this.seq>4095){this.seq=0;while(Date.now()<=e);}}else this.seq=0;this.lastTime=e;let n=this.seq.toString(2),i=this.mid.toString(2);while(n.length<12)n="0"+n;while(i.length<10)i="0"+i;const o=t+i+n;let r="";for(let s=o.length;s>0;s-=4)r=parseInt(o.substring(s-4,s),2).toString(16)+r;return c(r)}}var d=new u({mid:42,offset:1545264e6}),m={name:"UE",props:{value:{default:function(){return""}}},data:function(){return{mjx_assistive_mml_map:{},randomId:"editor_"+1e17*Math.random(),instance:null,ready:!1}},watch:{value:function(e,t){null!=e&&this.ready&&(this.instance=UE.getEditor(this.randomId),this.instance.setContent(e))}},mounted:function(){this.initEditor()},beforeDestroy:function(){null!==this.instance&&this.instance.destroy&&this.instance.destroy()},methods:{initEditor:function(){var e=this;this.$nextTick((function(){e.instance=UE.getEditor(e.randomId),e.instance.addListener("ready",(function(){e.ready=!0,e.$emit("ready",e.instance)}))}))},getUEContent:function(){return this.instance.getContent()},setUEHtml:function(){var e=window.frames[window.frames.length-1],t={scale:1.15,minScale:.5,exFactor:.5,display:!1,zoom:"DoubleClick"},n="a^2";n=n.replace(/tabular/g,"array"),console.log("value"),console.log(n);var i=window.MathJax.tex2svg(n,t),o=d.generate(),r=i.getElementsByTagName("svg")[0],s=i.getElementsByTagName("mjx-assistive-mml")[0];r.id=o,this.mjx_assistive_mml_map[o]=s;var a=document.createElement("span");a.innerHTML=r.outerHTML,a.onclick=function(e){console.log("evt"),console.log(e)},a.setAttribute("onclick","onclickOfSpan(this)");document.createElement("script");var l=a.outerHTML;r.onclick=function(e){console.log("e"),console.log(e),console.log("formula"),console.log(l)},console.log("formula"),console.log(l),e.document.body.innerHTML=l},getUEHtml:function(){var e=window.frames[window.frames.length-1],t=e.document.body.outerHTML;console.log("UEHtml"),console.log(t);var n=e.document.body,i=n.getElementsByTagName("svg"),o=this.mjx_assistive_mml_map[i[0].id];console.log("mjx_assistive_mml"),console.log(o)},getUEContentTest:function(){var e=this.getUEContent();console.log("UEContent"),console.log(e)},insertFomuleTest:function(){var e=this.getUEContent();console.log("UEContent"),console.log(e);var t=[/<\/?mjx-container[^>]*>/gi,/<\/?mjx-assistive-mml[^>]*>/gi,/<math[^>]*>.*<\/math>/gi,/<mfrac[^>]*>.*<\/mfrac>/gi],n={scale:1.15,minScale:.5,exFactor:.5,display:!1,zoom:"DoubleClick"},i="a^2";i=i.replace(/tabular/g,"array"),console.log("value"),console.log(i);var o=window.MathJax.tex2svg(i,n).outerHTML;console.log("window.MathJax.svg2text"),console.log(window.MathJax.svg2text),t.forEach((function(e){o=o.replace(e,"")})),console.log("formula"),console.log(o),this.instance.execCommand("insertHtml","<div style='color:red;'>res</div>")},setText:function(e){this.instance=UE.getEditor(this.randomId),this.instance.setContent(e)},insertFomule:function(){var e=[/<\/?mjx-container[^>]*>/gi,/<\/?mjx-assistive-mml[^>]*>/gi,/<math[^>]*>.*<\/math>/gi,/<mfrac[^>]*>.*<\/mfrac>/gi];if(!window.MathJax||!window.MathJax.version){var t=document.createElement("script");t.src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-svg.min.js",t.async=!0,t.id="MathJax-script",document.head.appendChild(t)}var n={scale:1.15,minScale:.5,exFactor:.5,display:!1,zoom:"DoubleClick"},i=document.getElementById("formulaInput").value;if(!i)return alert("请输入内容");i=i.replace(/tabular/g,"array"),console.log("value"),console.log(i);var o=window.MathJax.tex2svg(i,n).outerHTML;return console.log("window.MathJax.svg2text"),console.log(window.MathJax.svg2text),e.forEach((function(e){o=o.replace(e,"")})),console.log("formula"),console.log(o),wangEditor.cmd.do("insertHTML",o),!0}}},f=m,g=(n("7714"),n("e607")),h=Object(g["a"])(f,i,o,!1,null,"7018b81e",null);t["a"]=h.exports},7714:function(e,t,n){"use strict";n("28d7")}}]);